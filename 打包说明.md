# Material Review - macOS 打包说明

## 快速开始

### 一键打包

```bash
./build.sh
```

就这么简单！打包完成后会在 `dist` 目录生成 `MaterialReview.app`。

## 分发给同事

**注意：生成的程序是“绿色免安装版”，完全独立运行。**
**接收文件的同事电脑上 不需要 安装 Python，也不需要任何配置，直接能用。**

### 方法1：压缩分发

```bash
cd dist
zip -r MaterialReview.zip MaterialReview.app
```

将 `MaterialReview.zip` 发送给同事，解压后拖到应用程序文件夹即可。

### 方法2：直接复制

直接将 `dist/MaterialReview.app` 复制给同事。

## 使用说明

### 安装

1. 双击打开 `MaterialReview.app`
2. 如果提示"无法打开"，在终端执行：
   ```bash
   xattr -cr /Applications/MaterialReview.app
   ```

### 使用

应用会打开一个图形界面，包含三个标签页：

1. **测试连接** - 测试邮箱和 AI 连接
2. **视频审核** - 审核视频内容
3. **下载附件** - 下载邮件中的视频

所有操作都可以通过点击按钮完成，输出会显示在底部的日志区域。

## 配置

配置文件位于应用内部，如需修改：
1. 编辑项目根目录的 `config.yaml`
2. 重新运行 `./build.sh` 打包
3. 重新分发给同事

## 清理

如需清理打包文件：

```bash
rm -rf build dist *.spec
```

## 常见问题

### Q: 打包失败怎么办？

确保已安装所有依赖：
```bash
source venv/bin/activate
pip install -r requirements.txt
```

### Q: 应用无法打开？

```bash
xattr -cr /Applications/MaterialReview.app
```

### Q: 如何更新应用？

重新运行 `./build.sh`，然后重新分发新的 app 文件。

### Q: 可以在 Mac 上打包 Windows 版 (.exe) 吗？

**解决方法：**

**方法 1：使用 GitHub Actions (推荐 - 需使用 GitHub)**
*注意：此功能必须配合 GitHub 使用，Gitee (码云) 无法识别此配置。*
1. 注册/登录 [GitHub](https://github.com/)。
2. 创建一个新的仓库 (Repository)。
3. 将现有代码推送到 GitHub 仓库。
4. 进入仓库的 "Actions" 标签页。
5. 在左侧点击 "Build Windows App"，右侧点击 "Run workflow"。
6. 等待构建完成后，在 Artifacts 区域下载 `MaterialReview_Windows.zip`。

**方法 2：找台 Windows 电脑**
1. 将项目源码复制到 Windows 电脑。
2. 运行项目中的 `build_win.bat` 脚本。

## 技术说明

- 使用 PyInstaller 打包
- GUI 基于 tkinter（Python 内置，无需额外依赖）
- 使用 `--collect-all cv2` 确保 OpenCV 正确打包
- 使用 `--windowed` 创建 macOS 应用（无终端窗口）
